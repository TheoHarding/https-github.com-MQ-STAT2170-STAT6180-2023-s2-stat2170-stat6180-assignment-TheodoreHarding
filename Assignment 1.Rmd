---
title: "STAT2170 - Assignment 1" 
author: "Theodore Harding - 45234671"
date: "Due Date: 2023-10-27"
output: pdf_document
---
# Question 1

Load the traffic data
```{r}
traffic <- read.csv("traffic.csv")
```

## Part A
Calculate correlation matrix and create a scatterplot matrix
```{r}
cor(traffic)
pairs(traffic)

```

## Part B
Fit a linear regression model


```{r}
fit <- lm(spi ~ ., data = traffic)
summary(fit)
```

Calculate confidence interval for the 'weather' variable

```{r}
confint(fit, 'weather', level = 0.95)
```

## Part C
Display the summary of the linear regression model


```{r}
summary(fit)
```

Present the model equation

$spi = 62.8071 - 2.1750 * transport - 2.4097 * road + 4.2456 * weather - 3.6145 * fuel - 0.1358 * wind$

Null hypothesis: $Beta1 = Beta2 = ... = BetaN = 0$
Alternate hypothesis: $At least 1 Beta(i) != 0$


### Anova table for model comparison
```{r}
traffic$null <- mean(traffic$spi)
null_fit <- lm(spi ~ null, data = traffic)
summary(null_fit)
anova(null_fit, fit)
```

## Part D
Goodness of fit
```{r}
summary(fit)
```


## Part E
R-squared is a measure of the model fit and explained variability
```{r}
summary(fit)
```

## Part F (Stepwise Selection)
Forward stepwise selection

```{r}
fit <- lm(spi ~ transport + road + weather + fuel, data = traffic)
summary(fit)
```


Backward stepwise selection (removing 'fuel')
```{r}
fit <- lm(spi ~ transport + road + weather, data = traffic)
summary(fit)
```

## Part G
Adjusted R^2 takes into account the number of variables in the dataset



# Question 2

```{r}
cake <- read.csv("cake.csv")
```

## Part A
```{r}
table(cake$Temp, cake$Recipe)
```

Temp and recipe do have an impact on the angle the cake broke but the  interaction variable is insignificant 

It is balanced - there is the same number of subjects in each cohort

## Part B

```{r}
boxplot(cake$Angle~cake$Temp)

boxplot(cake$Angle~cake$Recipe)
```


## Part C
```{r}
av = aov(formula = Angle~Recipe*Temp, data = cake)
```

## Part D
```{r}
summary(av)
plot(av)  
```


## Part E
```{r}
me <- aov(formula = Angle~Recipe+Temp, data = cake)
summary(me)
plot(me)
```


